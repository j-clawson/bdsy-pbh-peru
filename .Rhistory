#Create a column for month
df$month <- as.factor(month(df$date))
df <- df %>%
group_by(region, year, month) %>%
summarise(under5 = sum(under5),
.groups = "drop"
)
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(year_month = floor_date(date, unit = "month")) %>%
group_by(region, year_month) %>%
summarise(under_5_deaths = sum(total_under_5), .groups = "drop")
#Format week in standard format
df <- df %>%
mutate(year_month = floor_date(date, unit = "month")) %>%
group_by(region, year_month) %>%
summarise(under_5_deaths = sum(under5), .groups = "drop")
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
year = year,
.groups = "drop"
)
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
df
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
#Create a year_month column (to smoothen the line plots)
df <- df %>%
mutate(year_month = floor_date(date, unit = "month")) %>%
group_by(region, year_month) %>%
summarise(total_under5 = sum(under5), .groups = 'drop')
df
region_to_point <- function(region_name, data) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = year_month, y = total_under5)) +
geom_line() + geom_point() +
labs(title = paste("Line Plot of Under-5 deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point(df, "AMAZONAS")
region_to_point(df, "AMAZONAS")
df
df %>% filter(region == "AMAZONAS")
region_to_point <- function(region_name, data) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = year_month, y = total_under5)) +
geom_line() + geom_point() +
labs(title = paste("Line Plot of Under-5 deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point(df, "AMAZONAS")
region_to_point("AMAZONAS", df)
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
df
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
#Create a year_month column (to smoothen the line plots)
df <- df %>%
mutate(year = floor_date(date, unit = "year")) %>%
group_by(region, year) %>%
summarise(total_under5 = sum(under5), .groups = 'drop')
df
region_to_point <- function(region_name, data) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = year_month, y = total_under5)) +
geom_line() + geom_point() +
labs(title = paste("Line Plot of Under-5 deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point("AMAZONAS", df)
region_to_point <- function(region_name, data) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = year, y = total_under5)) +
geom_line() + geom_point() +
labs(title = paste("Line Plot of Under-5 deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point("AMAZONAS", df)
ggplot(df %>% filter(region == "AMAZONAS"), aes(x = date, y = under5)) +
geom_point() +
labs(title = "<5 yo Deaths Scatter Plot",
x = "Date", y = "Counts") +
# Have y-axis for the two plots be the same.
ylim(0, NA) +
theme_linedraw() +
# Specify aspects of the theme plot formatting settings.
theme(panel.spacing = unit(2, 'lines'),
axis.text.x = element_text(angle = 90))
p1
p2
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = year, y = total_under5)) +
geom_line() +
geom_vline( data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccnine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Yearly <5 Deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point(df, "AMAZONAS")
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = year, y = total_under5)) +
geom_line() +
geom_vline(data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Yearly <5 Deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point(df, "AMAZONAS")
peru
#rows by region
peru %>% group_by(region) %>% summarise(n_obs = n())
df <- peru[c("year","week", "under_5_death", "over_60_death")]
#Group by year, week
df <- df %>%
group_by(year, week) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
total_over_60 = sum(over_60_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
over60 = sum(total_over_60,   na.rm = TRUE),
.groups = "drop"
)
df %>% group_by(region) %>% summarise(n_obs = n())
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
DF
df
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
df %>% group_by(region) %>% summarise(n_obs = n())
peru %>% group_by(region) %>% summarise(n_obs = n())
peru
df <- peru[c("year","week", "under_5_death", "over_60_death")]
#Group by year, week
df <- df %>%
group_by(year, week) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
total_over_60 = sum(over_60_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
over60 = sum(total_over_60,   na.rm = TRUE),
.groups = "drop"
)
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
df <- df %>%
mutate(year = floor_date(date, unit = "year")) %>%
group_by(region, year) %>%
summarise(total_under5 = sum(under5), .groups = 'drop')
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
df
df <- df %>%
mutate(date = floor_date(date, unit = "month")) %>%
group_by(region, date) %>%
summarise(total_under5 = sum(under5), .groups = 'drop')
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
df <- df %>%
mutate(date = floor_date(date, unit = "month")) %>%
group_by(region, date) %>%
summarise(total_under5 = sum(under5), .groups = 'drop')
df
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
df %>% count(region)
deaths_by_region <- peru %>%
group_by(region) %>%
summarise(total_deaths = sum(under_5_deaths), .groups = "drop")
colnames(peru)
deaths_by_region <- peru %>%
group_by(region) %>%
summarise(total_deaths = sum(under_5_death), .groups = "drop")
hist(deaths_by_region)
deaths_by_region
hist(deaths_by_region$total_deaths)
p3 <- ggplot(deaths_by_region, aes(x = region, y = total_deaths)) +
geom_col()
p3
p3 <- ggplot(deaths_by_region, aes(x = region, y = total_deaths)) +
geom_col(fill = "skyblue") +
labs(
title = "Total Under-5 Deaths by Region",
x = "Region",
y = "Total Under-5 Deaths"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
p3
df <- peru[c("year","week", "region", "under_5_death")]
#Group by year, week
df <- df %>%
group_by(year, week, region) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
.groups = "drop"
)
#Format week in standard format
df <- df %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#Aggregate into monthly counts
df <- df %>%
mutate(date = floor_date(date, "month")) %>%
group_by(date, region) %>%
summarise(
under5 = sum(total_under_5,   na.rm = TRUE),
.groups = "drop"
)
df
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = date, y = total_under5)) +
geom_line() +
geom_vline(data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Yearly <5 Deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point(df, "AMAZONAS")
df
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = date, y = under5)) +
geom_line() +
geom_vline(data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Yearly <5 Deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
region_to_point(df, "AMAZONAS")
unique(peru$region)
region_to_point(df, "PASCO")
region_to_point(df, "PUNO")
p3
region_to_point(df, "PUNO")
region_to_point(df, "AMAZONAS")
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = date, y = under5)) +
geom_line() +
geom_vline(data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Yearly <5 Deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
unique(df$region)
p3
p4a <- region_to_point(df, "PUNO")
p4b <- region_to_point(df, "CALLAO")
grid.arrange(p4a, p4b. nrow = 2)
grid.arrange(p4a, p4b, nrow = 2)
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = date, y = under5)) +
geom_line() +
geom_vline(data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Monthly <5 Deaths in ", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
p4a <- region_to_point(df, "PUNO")
grid.arrange(p4a, p4b, nrow = 2)
p4b <- region_to_point(df, "CALLAO")
grid.arrange(p4a, p4b, nrow = 2)
region_to_point <- function(data, region_name) {
data <- data %>% filter(region == region_name)
p <- ggplot(data, aes(x = date, y = under5)) +
geom_line() +
geom_vline(data = vaccine_dates, aes(xintercept = date, colour = vaccine, linetype = vaccine), size = 0.8) +
scale_colour_brewer(name = "Vaccine Introduction", palette = "Dark2") +
scale_linetype_discrete(name = "Vaccine Introduction") +
labs(title = paste("Monthly <5 Deaths in", region_name), x = "Date", y = "Deaths") +
theme_minimal()
p
}
p4a <- region_to_point(df, "PUNO")
p4b <- region_to_point(df, "CALLAO")
grid.arrange(p4a, p4b, nrow = 2)
p3
p4a <- region_to_point(df, "PUNO")
p4b <- region_to_point(df, "CUSCO")
grid.arrange(p4a, p4b, nrow = 2)
unique(df$region)
length
length(unique(df$region))
p4a <- region_to_point(df, "SAN MARTIN")
p4b <- region_to_point(df, "CUSCO")
grid.arrange(p4a, p4b, nrow = 2)
p4a <- region_to_point(df, "PUNO")
p4b <- region_to_point(df, "CUSCO")
grid.arrange(p4a, p4b, nrow = 2)
p3
p4a <- region_to_point(df, "SAN MARTIN")
p4b <- region_to_point(df, "MOQUEGUA")
grid.arrange(p4a, p4b, nrow = 2)
p3
p3a
p4a
p4b
p3
p4b <- region_to_point(df, "PUNO")
p4
p4b
