geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = year, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
head(total_deaths_by_year_week)
#| fig.width: 8
#| fig.height: 4
td <- total_deaths_by_year_week %>%
mutate(
week_start = ISOweek2date(
paste0(year, "-W", sprintf("%02d", week), "-1")
)
)
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p1 <-
ggplot(td2, aes(x = frac_year, y = total_under_5)) +
geom_point() +
geom_vline(xintercept = pcv10.intro.date, colour = "red", linetype = 2) +
geom_vline(xintercept = pcv13.intro.date, colour = "green", linetype = 2) +
scale_x_continuous(
breaks = unique(td2$year),
labels = unique(td2$year)
) +
labs(
title = "Total deaths for <5 yo in Peru",
x     = "Year",
y     = "Count"
) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = year, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| message: FALSE
#| warning: FALSE
suppressPackageStartupMessages({
library("readr")      # For reading in the data
library("tibble")     # For handling tidyverse tibble data classes
library("tidyr")      # For tidying data
library("dplyr")      # For data manipulation
library("stringr")    # For string manipulation
library("MASS")       # Functions/datasets for statistical analysis
library("lubridate")  # For date manipulation
library("ggplot2")    # For creating static visualizations
library("scales")     # For formatting plots axis
library("gridExtra")  # Creates multiple grid-based plots
library("ISOweek")    # for ISOweek2date()
library("scales")     # for date_breaks()
})
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p1 <-
ggplot(td, aes(x = week_start, y = total_under_5)) +
geom_point() +
geom_vline(xintercept = as.Date(pcv10.intro.date),
colour = "red", linetype = 2) +
geom_vline(xintercept = as.Date(pcv13.intro.date),
colour = "green", linetype = 2) +
scale_x_date(
date_breaks = "1 year",
date_labels = "%Y"
) +
labs(
title = "Total deaths for <5 yo in Peru",
x     = "Year",
y     = "Count"
) +
theme_linedraw()
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p1 <-
ggplot(td2, aes(x = frac_year, y = total_under_5)) +
geom_point() +
geom_vline(xintercept = pcv10.intro.date, colour = "red", linetype = 2) +
geom_vline(xintercept = pcv13.intro.date, colour = "green", linetype = 2) +
scale_x_continuous(
breaks = unique(td2$year),
labels = unique(td2$year)
) +
labs(
title = "Total deaths for <5 yo in Peru",
x     = "Year",
y     = "Count"
) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = year, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
#grid.arrange(p1, p2, nrow = 1)
p1
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p1 <-
ggplot(td2, aes(x = frac_year, y = total_under_5)) +
geom_point() +
scale_x_continuous(breaks = unique(td2$year), labels = unique(td2$year)) +
labs(title = "Deaths Categorized by\nICD-10 Codes J12-18",
x = "Date", y = "Counts for <5 yo") +
geom_vline(xintercept = pcv10.intro.date, colour = "red", linetype = 2) +
geom_vline(xintercept = pcv13.intro.date, colour = "green", linetype = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = year, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p1 <-
ggplot(td2, aes(x = frac_year, y = total_under_5)) +
geom_point() +
scale_x_continuous(
breaks      = seq(2000, 2020, by = 5),
minor_breaks = seq(2000, 2020, by = 1),
labels      = seq(2000, 2020, by = 5)) +
labs(title = "Deaths Categorized by\nICD-10 Codes J12-18",
x = "Date", y = "Counts for <5 yo") +
geom_vline(xintercept = pcv10.intro.date, colour = "red", linetype = 2) +
geom_vline(xintercept = pcv13.intro.date, colour = "green", linetype = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = year, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
head(total_deaths_by_year_week)
total_deaths_df <- df_cases[c("year","week", "under_5_death", "over_60_death")]
total_deaths_by_year <- total_deaths_df %>%
group_by(year) %>%
summarise(
total_under_5   = sum(under_5_death, na.rm = TRUE),
total_over_60   = sum(over_60_death, na.rm = TRUE)
)
total_deaths_by_year_week <- total_deaths_df %>%
group_by(year, week) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
total_over_60 = sum(over_60_death, na.rm = TRUE),
.groups = "drop"
)
total_deaths_by_year_week %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
#grid.arrange(p1, p2, nrow = 1)
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 8
#| fig.height: 4
td2 <- total_deaths_by_year_week %>%
mutate(
frac_year = year + (week - 1) / 52
)
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
total_deaths_df <- df_cases[c("year","week", "under_5_death", "over_60_death")]
total_deaths_by_year <- total_deaths_df %>%
group_by(year) %>%
summarise(
total_under_5   = sum(under_5_death, na.rm = TRUE),
total_over_60   = sum(over_60_death, na.rm = TRUE)
)
total_deaths_by_year_week <- total_deaths_df %>%
group_by(year, week) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
total_over_60 = sum(over_60_death, na.rm = TRUE),
.groups = "drop"
)
total_deaths_by_year_week %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#| fig.width: 8
#| fig.height: 4
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 8
#| fig.height: 4
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
total_deaths_df <- df_cases[c("year","week", "under_5_death", "over_60_death")]
total_deaths_by_year <- total_deaths_df %>%
group_by(year) %>%
summarise(
total_under_5   = sum(under_5_death, na.rm = TRUE),
total_over_60   = sum(over_60_death, na.rm = TRUE)
)
total_deaths_by_year_week <- total_deaths_df %>%
group_by(year, week) %>%
summarise(
total_under_5 = sum(under_5_death, na.rm = TRUE),
total_over_60 = sum(over_60_death, na.rm = TRUE),
.groups = "drop"
)
total_deaths_by_year_week <- total_deaths_by_year_week %>%
mutate(date = as.Date(paste0(year, '-01-01')) + weeks(week-1))
#| fig.width: 8
#| fig.height: 4
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 15
#| fig.height: 4
#| fig.width: 15
#| fig.height: 4
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 15
#| fig.height: 8
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 15
#| fig.height: 8
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 15
#| fig.height: 6
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
#| fig.width: 15
#| fig.height: 6
p1 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_under_5)) +
geom_point() +
labs(title = "Total deaths for <5 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
p2 <-
ggplot(total_deaths_by_year_week, aes(x = date, y = total_over_60)) +
geom_point() +
labs(title = "Total deaths for >60 yo in Peru",
x = "Year", y = "Count") +
# Reference line.
geom_vline(xintercept = pcv10.intro.date, col = 'red', lty = 2) +
geom_vline(xintercept = pcv13.intro.date, col = 'green', lty = 2) +
theme_linedraw()
# Display the plots side-by-side.
grid.arrange(p1, p2, nrow = 1)
head(total_deaths_by_year_week)
